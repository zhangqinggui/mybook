##倒排索引

正排索引（forward index），倒排索引（inverted index）。
 
###正排索引（forward index）

1. LocalId字段（表中简称"Lid"）：表示一个文档的局部编号。
2. WordId字段：表示文档分词后的编号，也可称为"索引词编号"。
3. NHits字段：表示某个索引词在文档中出现的次数。
4. HitList变长字段：表示某个索引词在文档中出现的位置，即相对于正文的偏移量。

正排索引以文档编号为视角看待索引词，也就是通过文档编号去找索引词。全文索引是通过关键词来检索，而不是通过文档编号来检索，因此正排索引不能满足全文检索的要求。

###倒排索引（inverted index）

一个倒排索引由文档中所有不重复词的列表构成，对于其中每个词，有一个包含它的文档列表。
- 文档(Document)：一般搜索引擎的处理对象是互联网网页，而文档这个概念要更宽泛些，代表以文本形式存在的存储对象，相比网页来说，涵盖更多种形式，比如Word，PDF，html，XML等不同格式的文件都可以称之为文档。再比如一封邮件，一条短信，一条微博也可以称之为文档。在本书后续内容，很多情况下会使用文档来表征文本信息。
- 文档集合(Document Collection)：由若干文档构成的集合称之为文档集合。比如海量的互联网网页或者说大量的电子邮件都是文档集合的具体例子。
- 文档编号(Document ID)：在搜索引擎内部，会将文档集合内每个文档赋予一个唯一的内部编号，以此编号来作为这个文档的唯一标识，这样方便内部处理，每个文档的内部编号即称之为“文档编号”，后文有时会用DocID来便捷地代表文档编号。
- 倒排索引：倒排索引是实现“单词-文档矩阵”的一种具体存储形式，通过倒排索引，可以根据单词快速获取包含这个单词的文档列表。倒排索引主要由两个部分组成：“单词词典”和“倒排文件”。
- 单词编号(Word ID)：与文档编号类似，搜索引擎内部以唯一的编号来表征某个单词，单词编号可以作为某个单词的唯一表征。
- 单词词典(Lexicon)：搜索引擎的通常索引单位是单词，单词词典是由文档集合中出现过的所有单词构成的字符串集合，单词词典内每条索引项记载单词本身的一些信息以及指向“倒排列表”的指针。
- 倒排列表(PostingList)：倒排列表记载了出现过某个单词的所有文档的文档列表及单词在该文档中出现的位置信息，每条记录称为一个倒排项(Posting)。根据倒排列表，即可获知哪些文档包含某个单词。
- 倒排文件(Inverted File)：所有单词的倒排列表往往顺序地存储在磁盘的某个文件里，这个文件即被称之为倒排文件，倒排文件是存储倒排索引的物理文件。

### 倒排索引和B树索引对比

倒排索引：连续型的要使用B+树；缺点，需要多余的空间存储倒排表，降低了更新运算的效率

B树索引：
- 对唯一值极少的（低基数）数据字段几乎毫无价值
- 在数据仓库中构造和维护索引的代价高
- 对于带有分组及聚合条件的复杂查询无能为力，倒排可以位图简化


---
   
>Elasticsearch 从入门到跑路